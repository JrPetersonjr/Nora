<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Helper</title>
    <link rel="manifest" href="manifest.json">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://www.youtube.com/iframe_api"></script>
    <script src="https://cdn.ckeditor.com/ckeditor5/39.0.0/classic/ckeditor.js"></script>
    <style>
        :root {
            --primary: #6c63ff;
            --primary-light: #f5f6fa;
            --accent: #ffb400;
            --bg: #f7f8fa;
            --card-bg: #fff;
            --text: #181818;
            --text-light: #444;
            --border: #d0d0d0;
            --shadow: 0 2px 16px rgba(108,99,255,0.08);
            --radius: 18px;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        @keyframes subtleFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(8px); }
        }

        @keyframes gentleRotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        body {
            font-family: 'Inter', system-ui, Arial, sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            margin: 0;
            padding: 0;
            line-height: 1.7;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 20% 50%, rgba(255, 140, 0, 0.03) 0%, transparent 50%),
                        radial-gradient(circle at 80% 80%, rgba(177, 156, 217, 0.02) 0%, transparent 50%);
            pointer-events: none;
            z-index: 1;
        }

        header {
            background: var(--primary-light);
            border-bottom: 1.5px solid var(--primary);
            padding: 2.2rem 0 1.2rem 0;
            position: relative;
            z-index: 100;
            box-shadow: var(--shadow);
        }
        
        header h1 {
            font-size: 2.2rem;
            color: var(--primary);
            margin: 0 2rem;
            font-weight: 700;
            letter-spacing: 1.5px;
            text-transform: none;
            text-shadow: none;
            position: relative;
            z-index: 2;
        }
        
        header p {
            color: var(--text-light);
            margin: 0.5rem 2rem 0;
            font-size: 1.05rem;
            font-weight: 400;
            letter-spacing: 0.5px;
            position: relative;
            z-index: 2;
        }

        .nav-container {
            background: rgba(10, 14, 39, 0.8);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 140, 0, 0.2);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 99;
            box-shadow: inset 0 1px 0 rgba(255, 180, 0, 0.1);
        }

        .dropdown {
            position: relative;
            display: inline-block;
        }

        .dropdown-btn {
            background: var(--primary);
            color: #fff;
            border: none;
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            position: relative;
            overflow: hidden;
        }

        .dropdown-btn:hover {
            background: var(--accent);
            color: var(--text);
            transform: translateY(-2px);
            box-shadow: 0 0 15px rgba(255, 140, 0, 0.2);
        }

        .dropdown-btn.active {
            background: var(--accent);
            color: var(--text);
            box-shadow: 0 0 20px rgba(255, 180, 0, 0.2), inset 0 0 10px rgba(255, 180, 0, 0.1);
            text-shadow: none;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            background: var(--card-bg);
            min-width: 200px;
            box-shadow: 0 8px 32px rgba(255, 140, 0, 0.2);
            padding: 0.5rem 0;
            z-index: 1;
            border-radius: 8px;
            border: 1px solid rgba(255, 140, 0, 0.3);
            backdrop-filter: blur(10px);
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .dropdown-content button {
            display: block;
            width: 100%;
            text-align: left;
            background: transparent;
            color: var(--primary);
            border: none;
            padding: 0.75rem 1.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin: 0;
            border-left: 3px solid transparent;
        }

        .dropdown-content button:hover {
            background: var(--primary-light);
            color: var(--accent);
            border-left-color: var(--accent);
            padding-left: 2rem;
        }

        .dropdown-content button.active {
            background: var(--primary-light);
            color: var(--accent);
            border-left-color: var(--accent);
            box-shadow: inset 0 0 10px rgba(255, 140, 0, 0.08);
        }

        .dropdown-content.show {
            display: block;
        }

        main {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            position: relative;
            z-index: 2;
        }

        main::before {
            content: '';
            position: absolute;
            top: -50%;
            right: 5%;
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, rgba(255, 140, 0, 0.05) 0%, transparent 70%);
            border-radius: 50%;
            animation: gentleRotate 20s linear infinite;
            pointer-events: none;
        }

        .tabcontent {
            display: none;
            animation: fadeIn 0.4s ease;
            background: var(--card-bg);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            margin-bottom: 2.5rem;
            padding: 2.2rem;
        }
        
        .tabcontent.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h2 {
            color: var(--primary);
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
            font-weight: 600;
            letter-spacing: 1px;
            text-shadow: none;
            position: relative;
            padding-bottom: 0.5rem;
        }

        h2::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 2px;
            background: linear-gradient(90deg, rgba(255, 140, 0, 0.8), transparent);
            border-radius: 1px;
        }

        h3 {
            color: var(--primary);
            font-size: 1.2rem;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            font-weight: 500;
            text-shadow: none;
        }

        p {
            color: var(--text-light);
            margin-bottom: 1.5rem;
            font-weight: 400;
        }

        input[type="text"],
        input[type="number"],
        select,
        textarea {
            background: #fff;
            color: var(--text);
            border: 1px solid var(--border);
            padding: 0.8rem 1rem;
            border-radius: 6px;
            font-size: 1rem;
            font-family: inherit;
            transition: all 0.3s ease;
            margin-bottom: 1rem;
            width: 100%;
            max-width: 400px;
            box-shadow: inset 0 0 10px rgba(255, 140, 0, 0.05);
        }

        input[type="text"]:focus,
        input[type="number"]:focus,
        select:focus,
        textarea:focus {
            background: rgba(30, 40, 70, 0.8);
            border-color: #FFB400;
            outline: none;
            box-shadow: 0 0 20px rgba(255, 140, 0, 0.3), inset 0 0 10px rgba(255, 140, 0, 0.1);
        }

        button {
            background: var(--primary);
            color: #fff;
            border: none;
            padding: 0.9rem 1.7rem;
            font-size: 1.08rem;
            cursor: pointer;
            border-radius: var(--radius);
            transition: background 0.2s, box-shadow 0.2s, transform 0.1s;
            font-weight: 600;
            text-transform: none;
            letter-spacing: 0.2px;
            margin-right: 0.5rem;
            margin-bottom: 1rem;
            box-shadow: var(--shadow);
        }

        button:hover, button:focus {
            background: var(--accent);
            color: var(--text);
            transform: translateY(-2px) scale(1.03);
            box-shadow: 0 4px 24px rgba(255,180,0,0.13);
        }
        
        button:active {
            transform: translateY(0) scale(0.98);
        }

        .result-box {
            background: var(--primary-light);
            border-left: 4px solid var(--primary);
            padding: 1.3rem 1.2rem;
            border-radius: var(--radius);
            margin: 1.5rem 0;
            transition: all 0.3s ease;
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .result-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255, 140, 0, 0.4), transparent);
        }

        .result-box:hover {
            background: rgba(30, 40, 70, 0.6);
            border-left-color: #FFD700;
            box-shadow: 0 0 30px rgba(255, 140, 0, 0.25), inset 0 0 15px rgba(255, 140, 0, 0.1);
        }

        .result-box ul {
            list-style: none;
            margin-left: 0;
        }

        .result-box ul li {
            color: #c0c0c0;
            margin-bottom: 0.8rem;
            padding-left: 1.5rem;
            position: relative;
        }

        .result-box ul li:before {
            content: "â—†";
            position: absolute;
            left: 0;
            color: #b19cd9;
        }

        a {
            color: #FFB400;
            text-decoration: none;
            transition: all 0.3s ease;
            border-bottom: 1px solid transparent;
            text-shadow: 0 0 5px rgba(255, 140, 0, 0.3);
        }

        a:hover {
            color: #FFD700;
            border-bottom-color: #FFB400;
            text-shadow: 0 0 10px rgba(255, 140, 0, 0.8);
        }

        .calc-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.8rem;
            max-width: 400px;
            margin: 1rem 0;
        }

        .calc-display {
            grid-column: span 4;
            background: rgba(10, 14, 39, 0.8);
            color: #FFB400;
            padding: 1.5rem;
            font-size: 2rem;
            text-align: right;
            border: 2px solid rgba(255, 140, 0, 0.4);
            border-radius: 8px;
            margin-bottom: 0.5rem;
            font-weight: 300;
            letter-spacing: 1px;
            word-wrap: break-word;
            word-break: break-all;
            box-shadow: 0 0 20px rgba(255, 140, 0, 0.3), inset 0 0 20px rgba(255, 140, 0, 0.1);
            text-shadow: 0 0 10px rgba(255, 140, 0, 0.8);
        }

        .calc-grid button {
            padding: 1.2rem 0.5rem;
            font-size: 1.2rem;
            margin: 0;
        }

        .ck-editor__main {
            min-height: 400px;
            background: rgba(30, 40, 70, 0.4) !important;
        }

        .ck-content {
            color: var(--text) !important;
            background: #fff !important;
        }

        ul {
            margin-left: 1.5rem;
        }

        ul li {
            margin-bottom: 0.8rem;
            color: #c0c0c0;
        }

        iframe {
            border-radius: 8px;
            border: 1px solid rgba(138, 43, 226, 0.3);
        }

        .playlist-btn {
            margin: 0 !important;
        }

        .playlist-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .playlist-content.active {
            display: block;
        }

        @media (max-width: 900px) {
            main {
                padding: 0.5rem;
            }
            header h1 {
                font-size: 1.2rem;
            }
            h2 {
                font-size: 1.1rem;
            }
            .calc-grid {
                max-width: 100%;
                gap: 0.4rem;
            }
            .calc-display {
                font-size: 1.2rem;
                padding: 0.8rem;
            }
            .ck-editor__main {
                min-height: 200px;
            }
            .result-box, .playlist-content, #mindMapContainer, #stickyNotesContainer,
            #plannerContainer, #calendarView, #flashcardCreator, #quizSection {
                padding: 0.8rem !important;
            }
            input[type="text"],
            input[type="number"], select, textarea {
                font-size: 1rem;
                padding: 0.6rem 0.7rem;
                max-width: 100vw;
            }
            button {
                font-size: 1rem;
                padding: 0.7rem 1.1rem;
            }
        }

        @media (max-width: 600px) {
            main, header, .nav-container {
                padding-left: 0.2rem;
                padding-right: 0.2rem;
            }
            .dropdown-content {
                min-width: 120px;
                font-size: 0.95rem;
            }
            .tabcontent, .result-box, .playlist-content, #mindMapContainer,
            #stickyNotesContainer, #plannerContainer, #calendarView, #flashcardCreator,
            #quizSection {
                border-radius: 4px !important;
                padding: 0.5rem !important;
            }
            .calc-grid button,
            .playlist-content a, .dropdown-content button {
                font-size: 1rem;
                padding: 0.5rem 0.5rem;
            }
            .calc-display {
                font-size: 1rem;
                padding: 0.5rem;
            }
            .ck-editor__main {
                min-height: 120px;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>âœ¦ Student Helper âœ¦</h1>
        <p>A contemplative space for focused learning and growth</p>
    </header>

    <nav class="nav-container">
        <div class="dropdown">
            <button class="dropdown-btn" onclick="toggleDropdown()">â˜° Menu</button>
            <div id="dropdownContent" class="dropdown-content">
                <button onclick="showTabFromDropdown('editor')">Text Editor</button>
                <button onclick="showTabFromDropdown('calculator')">Calculator</button>
                <button onclick="showTabFromDropdown('search')">Search</button>
                <button onclick="showTabFromDropdown('thesaurus')">Thesaurus</button>
                <button onclick="showTabFromDropdown('factcheck')">Fact Check</button>
                <button onclick="showTabFromDropdown('aichat')">Ask AI</button>
                <button onclick="showTabFromDropdown('mindmap')">Mind Map & Notes</button>
                <button onclick="showTabFromDropdown('music')">Music</button>
                <button onclick="showTabFromDropdown('flashcards')">Flashcards & Quizzes</button>
                <button onclick="showTabFromDropdown('planner')">Calendar & Planner</button>
                <button onclick="showTabFromDropdown('video')">Videos</button>
                <button onclick="showTabFromDropdown('resources')">Resources</button>
                <button onclick="showTabFromDropdown('aiethics')">AI Ethics</button>
            </div>
        </div>
    </nav>

    <main>
        <div id="tab-editor" class="tabcontent active">
            <h2>Text Editor</h2>
            <p>Write and refine your thoughts. Check grammar, format citations, and detect AI-generated content.</p>
            <div id="editor-content"></div>
            <br>
            <button onclick="startVoiceInput()">ðŸŽ¤ Voice Input</button>
            <button onclick="readAloud()">ðŸ”Š Read Aloud</button>
            <br>
            <button onclick="checkGrammar()">Check Grammar</button>
            <select id="format">
                <option value="apa">APA</option>
                <option value="mla">MLA</option>
                <option value="chicago">Chicago</option>
            </select>
            <button onclick="formatText()">Citation Guide</button>
            <button onclick="toggleCitationGenerator()">Citation Generator</button>
            <div id="formatGuide"></div>
            <div id="citationGenerator" style="display:none; margin:1.5rem 0; background:rgba(30,40,70,0.3); border:1px solid rgba(255,140,0,0.2); border-radius:8px; padding:1.5rem;">
                <h3 style="color:#FFB400;">Citation Generator</h3>
                <p style="color:#c0c0c0;">Enter your source details and select a style. Always double-check and cite honestly!</p>
                <label>Type:
                    <select id="citeType">
                        <option value="book">Book</option>
                        <option value="article">Article</option>
                        <option value="website">Website</option>
                    </select>
                </label>
                <div id="citeFields"></div>
                <label>Style:
                    <select id="citeStyle">
                        <option value="apa">APA</option>
                        <option value="mla">MLA</option>
                        <option value="chicago">Chicago</option>
                    </select>
                </label>
                <button onclick="generateCitation()">Generate Citation</button>
                <div id="citationResult" style="margin-top:1rem;"></div>
                <p style="color:#b19cd9; font-size:0.9rem; margin-top:1.5rem;">Academic Integrity Reminder: Use citations to give credit. Do not use AI or this tool to fabricate sources. Always check your institution's policies.</p>
            </div>
            <br>
            <button onclick="checkAI()">Analyze Content</button>
            <button onclick="generateText()">Generate Text</button>
            <div id="aiCheckerResult"></div>
            <div id="plagiarismChecker" style="margin:2rem 0; background:rgba(30,40,70,0.3); border:1px solid rgba(255,140,0,0.2); border-radius:8px; padding:1.5rem;">
                <h3 style="color:#FFB400;">Plagiarism Checker</h3>
                <p style="color:#c0c0c0;">Paste your text below to check for originality. <strong>Never copy others' work. Use this tool to ensure your writing is your own and properly cited.</strong></p>
                <textarea id="plagiarismText" rows="6" style="width:100%; max-width:600px; background:rgba(30,40,70,0.6); color:#e0e0e0; border:1px solid rgba(255,140,0,0.2); border-radius:6px; margin-bottom:1rem;"></textarea>
                <div style="margin-bottom:1rem;">
                    <a href="https://www.quetext.com/" target="_blank" style="display:inline-block; margin-right:1rem; color:#FFB400;">Quetext (Free)</a>
                    <a href="https://plagiarismdetector.net/" target="_blank" style="display:inline-block; margin-right:1rem; color:#FFB400;">PlagiarismDetector.net</a>
                    <a href="https://www.prepostseo.com/plagiarism-checker" target="_blank" style="display:inline-block; color:#FFB400;">PrePostSEO</a>
                </div>
                <p style="color:#b19cd9; font-size:0.9rem; margin-top:1.5rem;">Academic Integrity Reminder: Plagiarism is a serious offense. Use this tool to check your work, not to bypass learning. Always cite your sources and write in your own words.</p>
            </div>
        </div>

        <div id="tab-calculator" class="tabcontent">
            <h2>Calculator</h2>
            <p>Quick calculations for when you need them.</p>
            <div class="calc-grid">
                <div class="calc-display" id="display">0</div>
                <button onclick="appendToDisplay('7')">7</button>
                <button onclick="appendToDisplay('8')">8</button>
                <button onclick="appendToDisplay('9')">9</button>
                <button onclick="appendToDisplay('+')">+</button>
                <button onclick="appendToDisplay('4')">4</button>
                <button onclick="appendToDisplay('5')">5</button>
                <button onclick="appendToDisplay('6')">6</button>
                <button onclick="appendToDisplay('-')">âˆ’</button>
                <button onclick="appendToDisplay('1')">1</button>
                <button onclick="appendToDisplay('2')">2</button>
                <button onclick="appendToDisplay('3')">3</button>
                <button onclick="appendToDisplay('*')">Ã—</button>
                <button onclick="appendToDisplay('0')">0</button>
                <button onclick="appendToDisplay('.')">â€¢</button>
                <button onclick="calculate()">=</button>
                <button onclick="appendToDisplay('/')">/</button>
            </div>
            <button onclick="clearDisplay()" style="margin-top: 1rem;">Clear</button>
        </div>

        <div id="tab-search" class="tabcontent">
            <h2>Search Engine</h2>
            <p>Find information. Remember to evaluate sources critically and think for yourself.</p>
            <form id="searchForm" action="https://www.google.com/search" method="get" target="_blank">
                <input type="text" id="searchInput" name="q" placeholder="What are you looking for?">
                <button type="submit">Search</button>
            </form>
        </div>

        <div id="tab-thesaurus" class="tabcontent">
            <h2>Thesaurus</h2>
            <p>Find synonyms to expand your vocabulary and refine your writing.</p>
            <input type="text" id="wordInput" placeholder="Enter a word">
            <button onclick="getSynonyms()">Find Synonyms</button>
            <div id="thesaurusResult"></div>
        </div>

        <div id="tab-factcheck" class="tabcontent">
            <h2>Fact Checker</h2>
            <p>Verify statements and claims using trusted fact-checking resources.</p>
            <input type="text" id="factInput" placeholder="Enter statement to fact-check">
            <button onclick="factCheck()">Fact Check</button>
            <div id="factCheckResult"></div>
        </div>

        <div id="tab-aichat" class="tabcontent">
            <h2>Ask AI</h2>
            <p>Ask questions and get thoughtful responses. Use this to explore ideas, get explanations, or brainstorm.</p>
            <div id="chatContainer" style="background: rgba(30, 40, 70, 0.3); border: 1px solid rgba(255, 140, 0, 0.2); border-radius: 8px; padding: 1.5rem; height: 400px; overflow-y: auto; margin-bottom: 1.5rem; display: flex; flex-direction: column;">
                <div id="chatMessages" style="flex: 1; display: flex; flex-direction: column; gap: 1rem;">
                    <div style="color: #888; text-align: center; padding: 2rem 1rem;">
                        <p>ðŸ‘‹ Welcome! Try questions like:</p>
                        <ul style="color:#b19cd9; text-align:left; max-width:350px; margin:1rem auto 0; font-size:0.98rem;">
                            <li>"Explain photosynthesis in simple terms."</li>
                            <li>"How do I cite a website in APA?"</li>
                            <li>"Give me a study plan for finals week."</li>
                            <li>"What are some tips for avoiding plagiarism?"</li>
                        </ul>
                        <p style="margin-top:1.5rem; color:#FFB400;">Remember: Use AI to learn, not to cheat!</p>
                    </div>
                </div>
            </div>
            <div style="display: flex; gap: 0.5rem;">
                <input type="text" id="aiQuestion" placeholder="Ask your question..." style="flex: 1;">
                <button onclick="askAI()" style="margin: 0;">Ask</button>
            </div>
            <p style="font-size: 0.85rem; color: #888; margin-top: 1rem;">ðŸ’¡ Tip: Ask about concepts, explanations, writing help, study strategies, or anything else on your mind.</p>
        </div>

        <div id="tab-music" class="tabcontent">
            <h2>Music for Focus</h2>
            <p>Curated open-source & creative commons electronic music. All royalty-free, all stay in this window.</p>
            <p style="color: #888; font-size: 0.9rem;"><strong>Coming soon:</strong> Curated playlists from Free Music Archive, Open Source Music, and more.</p>
        </div>

        <div id="tab-video" class="tabcontent">
            <h2>Video Courses</h2>
            <p>Watch educational content with transcript support.</p>
            <input type="text" id="videoUrl" placeholder="Enter YouTube video URL or ID">
            <button onclick="loadVideo()">Load Video</button>
            <button onclick="enableCaptions()">Enable Captions</button>
            <div id="player"></div>
            <p style="margin-top: 1.5rem; font-size: 0.9rem;">For full transcripts, use <a href="https://www.youtube-transcript.com/" target="_blank">YouTube Transcript</a>.</p>
        </div>

        <div id="tab-mindmap" class="tabcontent">
            <h2>Mind Map & Sticky Notes</h2>
            <p>Brainstorm, plan, and organize your ideas visually. Use this space for honest, creative thinkingâ€”never for copying answers.</p>
            <div id="mindMapContainer" style="background:rgba(30,40,70,0.3); border:1px solid rgba(255,140,0,0.2); border-radius:8px; padding:1.5rem; min-height:300px; margin-bottom:2rem;">
                <h3 style="color:#FFB400;">Mind Map</h3>
                <button onclick="addMindMapNode()" style="margin-bottom:1rem;">Add Node</button>
                <div id="mindMapNodes" style="display:flex; flex-wrap:wrap; gap:1rem;"></div>
            </div>

            <div id="stickyNotesContainer" style="background:rgba(30,40,70,0.2); border:1px solid rgba(255,140,0,0.1); border-radius:8px; padding:1.5rem;">
                <h3 style="color:#FFB400;">Sticky Notes</h3>
                <button onclick="addStickyNote()" style="margin-bottom:1rem;">Add Note</button>
                <div id="stickyNotes" style="display:flex; flex-wrap:wrap; gap:1rem;"></div>
            </div>
            <p style="color:#b19cd9; font-size:0.9rem; margin-top:1.5rem;">Academic Integrity Reminder: Use mind maps and notes to develop your own understanding. Do not use them to share or store answers for cheating.</p>
        </div>

        <div id="tab-flashcards" class="tabcontent">
            <h2>Flashcards & Quizzes</h2>
            <p>Create, review, and quiz yourself with flashcards. Use this tool to reinforce your learningâ€”never to share answers for cheating.</p>
            <div id="flashcardCreator" style="background:rgba(30,40,70,0.3); border:1px solid rgba(255,140,0,0.2); border-radius:8px; padding:1.5rem; margin-bottom:2rem;">
                <h3 style="color:#FFB400;">Create Flashcard</h3>
                <input type="text" id="flashcardQuestion" placeholder="Question / Term" style="width:100%;max-width:400px;margin-bottom:0.5rem;">
                <input type="text" id="flashcardAnswer" placeholder="Answer / Definition" style="width:100%;max-width:400px;margin-bottom:0.5rem;">
                <button onclick="addFlashcard()">Add Flashcard</button>
            </div>
            <div id="flashcardList" style="display:flex;flex-wrap:wrap;gap:1rem;margin-bottom:2rem;"></div>
            <div id="quizSection" style="background:rgba(30,40,70,0.2); border:1px solid rgba(255,140,0,0.1); border-radius:8px; padding:1.5rem;">
                <h3 style="color:#FFB400;">Quiz Yourself</h3>
                <button onclick="startQuiz()">Start Quiz</button>
                <div id="quizArea" style="margin-top:1rem;"></div>
            </div>
            <p style="color:#b19cd9; font-size:0.9rem; margin-top:1.5rem;">Academic Integrity Reminder: Use flashcards and quizzes to test your own knowledge. Do not use them to share or memorize answers for cheating.</p>
        </div>

        <div id="tab-planner" class="tabcontent">
            <h2>Calendar & Planner</h2>
            <p>Track assignments, deadlines, and study plans. Use this tool to stay organized and honest in your work.</p>
            <div id="plannerContainer" style="background:rgba(30,40,70,0.3); border:1px solid rgba(255,140,0,0.2); border-radius:8px; padding:1.5rem; margin-bottom:2rem;">
                <h3 style="color:#FFB400;">Add Assignment / Task</h3>
                <input type="text" id="taskTitle" placeholder="Task / Assignment" style="width:100%;max-width:400px;margin-bottom:0.5rem;">
                <input type="date" id="taskDate" style="width:100%;max-width:200px;margin-bottom:0.5rem;">
                <button onclick="addTask()">Add Task</button>
            </div>
            <div id="taskList" style="margin-bottom:2rem;"></div>
            <div id="calendarView" style="background:rgba(30,40,70,0.2); border:1px solid rgba(255,140,0,0.1); border-radius:8px; padding:1.5rem;">
                <h3 style="color:#FFB400;">Calendar</h3>
                <div id="calendarGrid" style="display:grid;grid-template-columns:repeat(7,1fr);gap:0.5rem;"></div>
            </div>
            <p style="color:#b19cd9; font-size:0.9rem; margin-top:1.5rem;">Academic Integrity Reminder: Use the planner to manage your own work and deadlines. Do not use it to coordinate cheating or share answers.</p>
        </div>

        <div id="tab-resources" class="tabcontent">
            <h2>Educational Resources</h2>
            <p>Curated links to help you learn and grow across many subjects.</p>
            <div style="margin-bottom: 2rem;">
                <h3>Learning Platforms</h3>
                <ul>
                    <li><a href="https://www.khanacademy.org/" target="_blank">Khan Academy</a> â€” Free courses on various subjects</li>
                    <li><a href="https://www.coursera.org/" target="_blank">Coursera</a> â€” Online courses from universities and institutions</li>
                    <li><a href="https://openstax.org/" target="_blank">OpenStax</a> â€” Free, peer-reviewed textbooks</li>
                    <li><a href="https://www.pbslearningmedia.org/" target="_blank">PBS LearningMedia</a> â€” Educational videos and resources</li>
                </ul>
            </div>
            <p style="margin-top: 2rem; color: #888; font-size: 0.9rem;">ðŸ’¡ Tip: Look for credible sources like academic journals, government sites, and established organizations. Use Google Scholar for peer-reviewed papers.</p>
        </div>

        <div id="tab-aiethics" class="tabcontent">
            <h2>Using AI Responsibly</h2>
            <p>AI is a powerful tool, but with that power comes responsibility. Here's how to use it ethically:</p>
            <ul>
                <li><strong>Use AI to enhance</strong> â€” Generate ideas, not complete assignments</li>
                <li><strong>Always cite</strong> â€” Attribute AI-generated content in your work</li>
                <li><strong>Verify everything</strong> â€” Check AI outputs against multiple reliable sources</li>
                <li><strong>Test your work</strong> â€” Use AI detectors to ensure your original voice comes through</li>
                <li><strong>Be transparent</strong> â€” Disclose when and how you used AI tools</li>
                <li><strong>Think critically</strong> â€” Focus on learning and understanding, not just completion</li>
                <li><strong>Know the rules</strong> â€” Check your institution's policies on AI use</li>
            </ul>
            <p style="margin-top: 2rem; color: #888; font-size: 0.9rem;">Remember: The goal of education is growth. Tools should serve your learning, not replace it.</p>
        </div>
    </main>

    <script>
        // Voice Input & Read Aloud
        function startVoiceInput() {
            if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                alert('Speech recognition not supported in this browser.');
                return;
            }
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            const recognition = new SpeechRecognition();
            recognition.lang = 'en-US';
            recognition.onresult = function(event) {
                const transcript = event.results[0][0].transcript;
                if (editor) {
                    editor.setData(editor.getData() + ' ' + transcript);
                }
            };
            recognition.start();
        }
        function readAloud() {
            if (!('speechSynthesis' in window)) {
                alert('Text-to-speech not supported in this browser.');
                return;
            }
            const text = editor ? editor.getData() : '';
            if (!text) {
                alert('Please write something first');
                return;
            }
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'en-US';
            window.speechSynthesis.speak(utterance);
        }

        // Calendar & Planner logic
        let tasks = [];
        function addTask() {
            const title = document.getElementById('taskTitle').value.trim();
            const date = document.getElementById('taskDate').value;
            if (!title || !date) { alert('Please enter both task and date.'); return; }
            tasks.push({title, date});
            document.getElementById('taskTitle').value = '';
            document.getElementById('taskDate').value = '';
            renderTasks();
            renderCalendar();
        }
        function renderTasks() {
            const list = document.getElementById('taskList');
            list.innerHTML = '';
            tasks.sort((a,b)=>a.date.localeCompare(b.date));
            tasks.forEach((task, idx) => {
                const taskDiv = document.createElement('div');
                taskDiv.style.cssText = 'background:#b19cd9;color:#222;padding:1rem;border-radius:8px;min-width:160px;position:relative;box-shadow:0 2px 8px rgba(0,0,0,0.1);margin-bottom:0.5rem;';
                taskDiv.innerHTML = `<strong>${task.title}</strong><br><span style='color:#888;'>Due: ${task.date}</span>`;
                const delBtn = document.createElement('button');
                delBtn.innerText = 'Ã—';
                delBtn.style.cssText = 'position:absolute;top:4px;right:4px;background:#FFB400;color:#222;border:none;border-radius:50%;width:24px;height:24px;cursor:pointer;font-size:1rem;';
                delBtn.onclick = () => { tasks.splice(idx,1); renderTasks(); renderCalendar(); };
                taskDiv.appendChild(delBtn);
                list.appendChild(taskDiv);
            });
        }
        function renderCalendar() {
            const grid = document.getElementById('calendarGrid');
            grid.innerHTML = '';
            const today = new Date();
            const year = today.getFullYear();
            const month = today.getMonth();
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month+1, 0).getDate();
            for (let i=0; i<firstDay; i++) {
                const emptyCell = document.createElement('div');
                grid.appendChild(emptyCell);
            }
            for (let d=1; d<=daysInMonth; d++) {
                const cell = document.createElement('div');
                cell.style.cssText = 'background:#b19cd9;color:#222;padding:0.5rem;border-radius:6px;min-height:40px;box-shadow:0 2px 8px rgba(0,0,0,0.05);text-align:center;';
                cell.innerText = d;
                const cellDate = `${year}-${String(month+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
                const dayTasks = tasks.filter(t=>t.date===cellDate);
                if (dayTasks.length) {
                    cell.style.background = '#FFB400';
                    cell.title = dayTasks.map(t=>t.title).join(', ');
                }
                grid.appendChild(cell);
            }
        }

        // Flashcards
        let flashcards = [];
        function addFlashcard() {
            const q = document.getElementById('flashcardQuestion').value.trim();
            const a = document.getElementById('flashcardAnswer').value.trim();
            if (!q || !a) { alert('Please enter both question and answer.'); return; }
            flashcards.push({q, a});
            document.getElementById('flashcardQuestion').value = '';
            document.getElementById('flashcardAnswer').value = '';
            renderFlashcards();
        }
        function renderFlashcards() {
            const list = document.getElementById('flashcardList');
            list.innerHTML = '';
            flashcards.forEach((card, idx) => {
                const cardDiv = document.createElement('div');
                cardDiv.style.cssText = 'background:#b19cd9;color:#222;padding:1rem;border-radius:8px;min-width:160px;min-height:60px;position:relative;box-shadow:0 2px 8px rgba(0,0,0,0.1);';
                cardDiv.innerHTML = `<strong>Q:</strong> ${card.q}<br><strong>A:</strong> ${card.a}`;
                const delBtn = document.createElement('button');
                delBtn.innerText = 'Ã—';
                delBtn.style.cssText = 'position:absolute;top:4px;right:4px;background:#FFB400;color:#222;border:none;border-radius:50%;width:24px;height:24px;cursor:pointer;font-size:1rem;';
                delBtn.onclick = () => { flashcards.splice(idx,1); renderFlashcards(); };
                cardDiv.appendChild(delBtn);
                list.appendChild(cardDiv);
            });
        }
        let quizIndex = 0, quizOrder = [], quizScore = 0;
        function startQuiz() {
            if (flashcards.length === 0) { alert('Add some flashcards first!'); return; }
            quizOrder = [...Array(flashcards.length).keys()].sort(()=>Math.random()-0.5);
            quizIndex = 0;
            quizScore = 0;
            showQuizCard();
        }
        function showQuizCard() {
            const area = document.getElementById('quizArea');
            if (quizIndex >= quizOrder.length) {
                area.innerHTML = `<div class='result-box'><strong>Quiz complete!</strong><br>Score: ${quizScore} / ${quizOrder.length}</div>`;
                return;
            }
            const card = flashcards[quizOrder[quizIndex]];
            area.innerHTML = `<div class='result-box'><strong>Q:</strong> ${card.q}<br><input type='text' id='quizAnswerInput' placeholder='Your answer...' style='width:100%;max-width:300px;margin-top:0.5rem;'><br><button onclick='submitQuizAnswer()'>Submit</button></div>`;
        }
        function submitQuizAnswer() {
            const card = flashcards[quizOrder[quizIndex]];
            const userAns = document.getElementById('quizAnswerInput').value.trim();
            if (userAns.toLowerCase() === card.a.toLowerCase()) quizScore++;
            quizIndex++;
            showQuizCard();
        }

        // Mind Map & Sticky Notes
        function addMindMapNode() {
            const nodeDiv = document.createElement('div');
            nodeDiv.style.cssText = 'background:#b19cd9;color:#222;padding:1rem;border-radius:8px;min-width:120px;min-height:60px;position:relative;box-shadow:0 2px 8px rgba(0,0,0,0.1);';
            nodeDiv.contentEditable = true;
            nodeDiv.innerText = 'New Idea';
            const delBtn = document.createElement('button');
            delBtn.innerText = 'Ã—';
            delBtn.style.cssText = 'position:absolute;top:4px;right:4px;background:#FFB400;color:#222;border:none;border-radius:50%;width:24px;height:24px;cursor:pointer;font-size:1rem;';
            delBtn.onclick = () => nodeDiv.remove();
            nodeDiv.appendChild(delBtn);
            document.getElementById('mindMapNodes').appendChild(nodeDiv);
        }
        function addStickyNote() {
            const noteDiv = document.createElement('div');
            noteDiv.style.cssText = 'background:#FFB400;color:#222;padding:1rem;border-radius:8px;min-width:120px;min-height:60px;position:relative;box-shadow:0 2px 8px rgba(0,0,0,0.1);';
            noteDiv.contentEditable = true;
            noteDiv.innerText = 'Note';
            const delBtn = document.createElement('button');
            delBtn.innerText = 'Ã—';
            delBtn.style.cssText = 'position:absolute;top:4px;right:4px;background:#b19cd9;color:#222;border:none;border-radius:50%;width:24px;height:24px;cursor:pointer;font-size:1rem;';
            delBtn.onclick = () => noteDiv.remove();
            noteDiv.appendChild(delBtn);
            document.getElementById('stickyNotes').appendChild(noteDiv);
        }

        // Citation Generator
        function toggleCitationGenerator() {
            const gen = document.getElementById('citationGenerator');
            gen.style.display = gen.style.display === 'none' ? 'block' : 'none';
            renderCiteFields();
        }
        function renderCiteFields() {
            const type = document.getElementById('citeType').value;
            let html = '';
            if (type === 'book') {
                html = `<label>Author: <input type="text" id="citeAuthor" placeholder="Last, First"></label><br>
                        <label>Title: <input type="text" id="citeTitle" placeholder="Book Title"></label><br>
                        <label>Year: <input type="text" id="citeYear" placeholder="2024"></label><br>
                        <label>Publisher: <input type="text" id="citePublisher" placeholder="Publisher"></label><br>`;
            } else if (type === 'article') {
                html = `<label>Author: <input type="text" id="citeAuthor" placeholder="Last, First"></label><br>
                        <label>Title: <input type="text" id="citeTitle" placeholder="Article Title"></label><br>
                        <label>Journal: <input type="text" id="citeJournal" placeholder="Journal Name"></label><br>
                        <label>Year: <input type="text" id="citeYear" placeholder="2024"></label><br>
                        <label>Volume: <input type="text" id="citeVolume" placeholder="12"></label><br>
                        <label>Pages: <input type="text" id="citePages" placeholder="123-145"></label><br>`;
            } else {
                html = `<label>Author: <input type="text" id="citeAuthor" placeholder="Last, First"></label><br>
                        <label>Title: <input type="text" id="citeTitle" placeholder="Webpage Title"></label><br>
                        <label>Website: <input type="text" id="citeWebsite" placeholder="Website Name"></label><br>
                        <label>Year: <input type="text" id="citeYear" placeholder="2024"></label><br>
                        <label>URL: <input type="text" id="citeURL" placeholder="https://..."></label><br>`;
            }
            document.getElementById('citeFields').innerHTML = html;
        }
        function generateCitation() {
            const type = document.getElementById('citeType').value;
            const style = document.getElementById('citeStyle').value;
            const author = document.getElementById('citeAuthor').value;
            const title = document.getElementById('citeTitle').value;
            const year = document.getElementById('citeYear').value;
            let citation = '';
            if (type === 'book') {
                const publisher = document.getElementById('citePublisher').value;
                if (style === 'apa') {
                    citation = `${author} (${year}). <i>${title}</i>. ${publisher}.`;
                } else if (style === 'mla') {
                    citation = `${author}. <i>${title}</i>. ${publisher}, ${year}.`;
                } else {
                    citation = `${author}. <i>${title}</i>. (${publisher}, ${year}).`;
                }
            } else if (type === 'article') {
                const journal = document.getElementById('citeJournal').value;
                const volume = document.getElementById('citeVolume').value;
                const pages = document.getElementById('citePages').value;
                if (style === 'apa') {
                    citation = `${author} (${year}). ${title}. <i>${journal}</i>, ${volume}, ${pages}.`;
                } else if (style === 'mla') {
                    citation = `${author}. "${title}." <i>${journal}</i>, vol. ${volume}, ${year}, pp. ${pages}.`;
                } else {
                    citation = `${author}. "${title}," <i>${journal}</i> ${volume} (${year}): ${pages}.`;
                }
            } else {
                const website = document.getElementById('citeWebsite').value;
                const url = document.getElementById('citeURL').value;
                if (style === 'apa') {
                    citation = `${author} (${year}). <i>${title}</i>. ${website}. ${url}`;
                } else if (style === 'mla') {
                    citation = `${author}. "${title}." <i>${website}</i>, ${year}, ${url}.`;
                } else {
                    citation = `${author}. "${title}." <i>${website}</i>. (${year}). ${url}`;
                }
            }
            document.getElementById('citationResult').innerHTML = `<div class='result-box'><strong>Citation:</strong><br>${citation}</div>`;
        }

        // Dropdown toggle
        function toggleDropdown() {
            const dropdown = document.getElementById('dropdownContent');
            dropdown.classList.toggle('show');
        }
        window.onclick = function(event) {
            if (!event.target.matches('.dropdown-btn')) {
                const dropdowns = document.querySelectorAll('.dropdown-content');
                dropdowns.forEach(dropdown => {
                    dropdown.classList.remove('show');
                });
            }
        }

        // Tab switching
        function showTab(tabName) {
            const tabs = document.querySelectorAll('.tabcontent');
            tabs.forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById('tab-' + tabName).classList.add('active');
        }

        function showTabFromDropdown(tabName) {
            showTab(tabName);
            const dropdown = document.getElementById('dropdownContent');
            dropdown.classList.remove('show');
        }

        // Initialize CKEditor
        document.addEventListener('DOMContentLoaded', function() {
            ClassicEditor
                .create(document.querySelector('#editor-content'), {
                    toolbar: ['heading', '|', 'bold', 'italic', 'underline', 'strikethrough', '|', 'bulletedList', 'numberedList', '|', 'link', 'blockQuote', '|', 'undo', 'redo']
                })
                .then(newEditor => {
                    editor = newEditor;
                    console.log('âœ“ Editor ready');
                })
                .catch(error => {
                    console.error('Editor error:', error);
                    // Fallback: make the div editable
                    const editorDiv = document.querySelector('#editor-content');
                    if (editorDiv) {
                        editorDiv.contentEditable = true;
                        editorDiv.style.minHeight = '200px';
                        editorDiv.style.border = '1px solid #ccc';
                        editorDiv.style.padding = '1rem';
                        console.log('Fallback editor enabled');
                    }
                });
        });

        // Calculator
        let display;
        document.addEventListener('DOMContentLoaded', function() {
            display = document.getElementById('display');
            if (!display) {
                console.error('Calculator display not found');
            }
        });
        function appendToDisplay(value) {
            if (display.innerText === '0') {
                display.innerText = value;
            } else {
                display.innerText += value;
            }
        }
        function clearDisplay() {
            display.innerText = '0';
        }
        function calculate() {
            try {
                display.innerText = eval(display.innerText);
            } catch {
                display.innerText = 'Error';
            }
        }

        // Thesaurus
        async function getSynonyms() {
            const word = document.getElementById('wordInput').value;
            if (!word) {
                alert('Please enter a word');
                return;
            }
            try {
                const response = await fetch(`https://api.datamuse.com/words?rel_syn=${word}`);
                const data = await response.json();
                const result = document.getElementById('thesaurusResult');
                if (data.length === 0) {
                    result.innerHTML = '<div class="result-box"><p>No synonyms found.</p></div>';
                } else {
                    result.innerHTML = '<div class="result-box"><h3>Synonyms for "' + word + '":</h3><ul>' + data.slice(0, 10).map(item => `<li>${item.word}</li>`).join('') + '</ul></div>';
                }
            } catch (error) {
                console.error('Thesaurus error:', error);
                // Fallback: basic synonyms
                const basicSynonyms = {
                    'good': ['excellent', 'great', 'fine', 'nice'],
                    'bad': ['poor', 'terrible', 'awful', 'horrible'],
                    'big': ['large', 'huge', 'enormous', 'massive'],
                    'small': ['tiny', 'little', 'miniature', 'petite'],
                    'happy': ['joyful', 'cheerful', 'delighted', 'pleased'],
                    'sad': ['unhappy', 'sorrowful', 'depressed', 'gloomy']
                };
                const synonyms = basicSynonyms[word.toLowerCase()] || [];
                const result = document.getElementById('thesaurusResult');
                if (synonyms.length > 0) {
                    result.innerHTML = '<div class="result-box"><h3>Synonyms for "' + word + '" (offline):</h3><ul>' + synonyms.map(s => `<li>${s}</li>`).join('') + '</ul></div>';
                } else {
                    result.innerHTML = '<div class="result-box"><p>No synonyms available offline for this word.</p></div>';
                }
            }
        }

        // Fact Check
        function factCheck() {
            const statement = document.getElementById('factInput').value;
            if (!statement) {
                alert('Please enter a statement');
                return;
            }
            const result = document.getElementById('factCheckResult');
            result.innerHTML = `<div class="result-box"><h3>Fact-Check Resources</h3><p>To verify this statement, visit:</p><ul><li><a href="https://www.factcheck.org/" target="_blank">FactCheck.org</a></li><li><a href="https://www.snopes.com/" target="_blank">Snopes</a></li><li><a href="https://www.politifact.com/" target="_blank">PolitiFact</a></li></ul></div>`;
        }

        // Grammar check
        async function checkGrammar() {
            if (!editor) {
                alert('Editor is loading. Please try again.');
                return;
            }
            const text = editor.getData();
            if (!text) {
                alert('Please write something first');
                return;
            }
            try {
                const response = await fetch('https://api.languagetool.org/v2/check', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/x-www-form-urlencoded'},
                    body: new URLSearchParams({text: text, language: 'en-US'})
                });
                const data = await response.json();
                if (data.matches && data.matches.length > 0) {
                    let correctedText = text;
                    data.matches.reverse().forEach(match => {
                        const replacement = match.replacements[0]?.value || '';
                        correctedText = correctedText.substring(0, match.offset) + replacement + correctedText.substring(match.offset + match.length);
                    });
                    editor.setData(correctedText);
                    alert(data.matches.length + ' corrections applied.');
                } else {
                    alert('No grammar issues found. Nice work!');
                }
            } catch (error) {
                console.error('Grammar check error:', error);
                // Fallback: basic checks
                let correctedText = text;
                let corrections = 0;
                
                // Basic checks
                if (text.includes('  ')) {
                    correctedText = correctedText.replace(/  +/g, ' ');
                    corrections++;
                }
                if (text.match(/\bi\b/g)) {
                    correctedText = correctedText.replace(/\bi\b/g, 'I');
                    corrections++;
                }
                
                if (corrections > 0) {
                    editor.setData(correctedText);
                    alert(corrections + ' basic corrections applied. For advanced grammar checking, check your internet connection.');
                } else {
                    alert('Basic grammar check passed. For advanced checking, ensure internet connection.');
                }
            }
        }

        // Format guide
        function formatText() {
            const format = document.getElementById('format').value;
            const guide = document.getElementById('formatGuide');
            if (format === 'apa') {
                guide.innerHTML = `<div class="result-box"><h3>APA Format Guide</h3><p><strong>In-text citation:</strong> (Author, Year)</p><p><strong>Reference:</strong> Author. (Year). Title. Publisher.</p></div>`;
            } else if (format === 'mla') {
                guide.innerHTML = `<div class="result-box"><h3>MLA Format Guide</h3><p><strong>In-text citation:</strong> (Author Page)</p><p><strong>Works Cited:</strong> Author. Title. Publisher, Year.</p></div>`;
            } else if (format === 'chicago') {
                guide.innerHTML = `<div class="result-box"><h3>Chicago Format Guide</h3><p><strong>Notes and Bibliography:</strong> Superscript numbers in text, full citations in footnotes.</p></div>`;
            }
        }

        // Check AI
        function checkAI() {
            if (!editor) {
                alert('Editor is loading.');
                return;
            }
            const text = editor.getData();
            if (!text) {
                alert('Please write something first');
                return;
            }
            const result = document.getElementById('aiCheckerResult');
            result.innerHTML = `<div class="result-box"><h3>Content Analysis</h3><p><strong>Word count:</strong> ${text.split(/\s+/).length}</p><p>For detailed AI detection, use specialized tools:<ul><li><a href="https://www.originality.ai/" target="_blank">Originality.ai</a></li><li><a href="https://www.turnitin.com/" target="_blank">Turnitin</a></li></ul></p></div>`;
        }

        // Generate text
        async function generateText() {
            if (!editor) {
                alert('Editor is loading or not available.');
                return;
            }
            const prompt = editor.getData();
            if (!prompt.trim()) {
                alert('Please enter a prompt first');
                return;
            }
            try {
                alert('Generating... This may take a moment.');
                const response = await fetch('https://api-inference.huggingface.co/models/distilgpt2', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({inputs: prompt, parameters: {max_length: 100, temperature: 0.7}})
                });
                const data = await response.json();
                if (data && data[0] && data[0].generated_text) {
                    editor.setData(prompt + ' ' + data[0].generated_text);
                    alert('Text generated. Review and edit as needed.');
                } else {
                    // Fallback: simple local generation
                    const fallbackText = prompt + ' [AI Generation failed - using local fallback] Here are some ideas to expand on this topic: 1. Consider the main points. 2. Add examples. 3. Include supporting evidence. 4. Conclude with key takeaways.';
                    editor.setData(fallbackText);
                    alert('AI generation failed. Using local fallback. Please review and edit.');
                }
            } catch (error) {
                console.error('Generation error:', error);
                // Fallback: simple local generation
                const fallbackText = prompt + ' [AI Generation unavailable] Here are some ideas to expand on this topic: 1. Consider the main points. 2. Add examples. 3. Include supporting evidence. 4. Conclude with key takeaways.';
                editor.setData(fallbackText);
                alert('AI generation failed. Using local fallback. Please review and edit.');
            }
        }

        // Service worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(reg => console.log('âœ“ Service Worker registered'))
                    .catch(err => console.log('Service Worker failed:', err));
            });
        }

        // YouTube player
        let player;
        function onYouTubeIframeAPIReady() {
            player = new YT.Player('player', {
                height: '390',
                width: '640',
                videoId: 'dQw4w9WgXcQ',
                events: {'onReady': onPlayerReady}
            });
        }
        function onPlayerReady(event) {
            console.log('âœ“ Player ready');
        }
        function loadVideo() {
            const url = document.getElementById('videoUrl').value;
            if (!url) {
                alert('Please enter a video URL or ID');
                return;
            }
            const videoId = url.split('v=')[1] || url.split('/').pop();
            if (player && videoId) {
                player.loadVideoById(videoId);
            } else if (!player) {
                alert('Player not loaded yet');
            }
        }
        function enableCaptions() {
            if (player) {
                player.setOption('captions', 'track', {'languageCode': 'en'});
                alert('Captions enabled');
            } else {
                alert('Load a video first');
            }
        }

        // AI Chat
        let chatHistory = [];
        function addChatMessage(message, isUser) {
            const messagesContainer = document.getElementById('chatMessages');
            const placeholder = messagesContainer.querySelector('[style*="text-align: center"]');
            if (placeholder) placeholder.remove();
            const messageDiv = document.createElement('div');
            messageDiv.style.cssText = `padding: 1rem; border-radius: 8px; max-width: 85%; word-wrap: break-word; ${isUser ? 'background: rgba(138, 43, 226, 0.3); color: #d8bfd8; border: 1px solid rgba(255, 140, 0, 0.2);' : 'background: rgba(30, 40, 70, 0.5); color: #c0c0c0; border-left: 3px solid #FFB400;'}`;
            messageDiv.textContent = message;
            messagesContainer.appendChild(messageDiv);
            document.getElementById('chatContainer').scrollTop = document.getElementById('chatContainer').scrollHeight;
        }
        async function askAI() {
            const question = document.getElementById('aiQuestion').value;
            if (!question.trim()) {
                alert('Please ask a question');
                return;
            }
            addChatMessage(question, true);
            document.getElementById('aiQuestion').value = '';
            chatHistory.push({ role: 'user', content: question });
            const aiResponse = generateLocalResponse(question);
            addChatMessage(aiResponse, false);
            chatHistory.push({ role: 'assistant', content: aiResponse });
        }
        function generateLocalResponse(question) {
            const q = question.toLowerCase();
            if (q.includes('how')) return 'That\'s a great question! Break it into smaller steps, research examples, practice, and ask for feedback. What specifically would you like help with?';
            if (q.includes('what')) return 'Great question! Could you provide more context? That way I can give you a more precise explanation.';
            if (q.includes('explain')) return 'I\'d be happy to explain! What aspect would you like me to focus on?';
            if (q.includes('study')) return 'Here are effective strategies: active recall, spaced repetition, teach someone else, make connections. What subject are you studying?';
            return 'That\'s an interesting question! What\'s the context? What have you already tried? Feel free to ask follow-up questions!';
        }

        // Render calendar on load
        document.addEventListener('DOMContentLoaded', renderCalendar);
    </script>
</body>
</html>
